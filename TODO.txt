Now that the basic server is working it is time to establish specific
things I need to do.

* break up resync all in to:
  * find new folders
  * resync on folders that have not been resync'd in <n> (five?) minutes
  * expire active folders that are around past their expiry

* add continuing and queued work support per mailbox
  XXX Still needs tweaking but it basically works now.
  o we still need to add proper support for this with 'search' !! Definitely!
  o we need to look at our STORE support and see if it needs any tweaking.

* add 'MailboxInconsistency' exception and handlers at the client.py
  that when they get this have a better idea what to do (things like
  'send a BAD to the client, 'be silent and retry command',
  'disconnect client')

  XXX 1/4 implemented. We have the exception and some commands grok it
      and restart.

* Handle mailbox.MH and mailbox.MHMessage exceptions like 'malformed
  sequence' and such.. like MailboxInconsistency.. mostly we just need
  to retry since the problem wil be fixed by the time we get to it
  again.. usually it is because we and some MH command were fighting
  over things liek the .sequences file.

  XXX I think I have this.. but really it needs to be tested and I am
      not quite happy how I am handling the exception. I almost think
      I should be handling it at a lower level. Too much repeating
      myself in code.

* Watching Mail.app if a folder has pending expunges we send back
  No's, but it keeps trying to do fetch's.. I wonder if we should do
  an unceremonious close on a client if it asks for FETCH's like 10
  times in a row while there are pending expunges.

  XXX Yet to see if this actually works.

* add mulitple port (ssl/non-ssl) support

  XXX have not tested this yet, but then SSL support is there but does
      not work properly when Mail.app is talking to us (but 'openssl
      s_client' works fine)

* add UIDPLUS (rfc4315) support

* write tool to split huge mailboxes in to mailbox + sub-mailbox by
  year, keeping the last 1,000 messages in the current folder.

* fix logging so each subprocess output goes to its own logfile (named
  with local and imap user names)

* daemonize properly.

* add proper unix account authentication support
  * make sure we change to the right user
  * Must support throttling so that brute forcing causes lock outs.
    untested! (right now it is 3 bad auths in 60 seconds locks out
    that IP address, 4 bad auths in 60 seconds for a specific user
    locks out that user name for 60 seconds.)

* fix renaming folders with subfolders

* add SSL support

* fix literal+ support

* implement rfc3348 the 'child mailbox extension'

o some sort of intelligent fallback for messages with malformed
  headers such that we can not find the UID properly.

o make COPY command queue'able.

o make SEARCH command queue'able again.

o add a better test system so we can run the full server but have it
  not run as root, and not change to a user upon auth, and have the mail
  dir exist in a set well known place.

o add command/response tracing facility and hook it into the ability
  to run regression tests against a running server.

o write a unit test suite for the components we can test separately
  (like IMAP message parsing, search & fetch over a set of test
  messages.)
